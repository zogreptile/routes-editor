(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(69),c=n.n(o),i=n(17),s=n(71),u=n.n(s),l=n(8),p=n(73),m=n(18),h=n.n(m),d=n(19),g=n(45),b=n(2),f=n(3),v=n(5),O=n(4),j=n(6),C=n(72),y=n.n(C),E=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.onChange,a=e.onSubmit;return r.a.createElement("form",{className:"search-bar",onSubmit:a},r.a.createElement("input",{className:"search-bar__input",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441",value:t,onChange:n}))}}]),t}(r.a.PureComponent),S={center:[55.75,37.57],zoom:14},D="listItem",R=Object(i.DropTarget)(D,{drop:function(e,t,n){if(!n)return null;var a=t.getItem().index,r=e.index;a!==r&&(e.onDrop(a,r),t.getItem().index=r)}},function(e,t){return{connectDropTarget:e.dropTarget(),isHovering:t.isOver()}})(Object(i.DragSource)(D,{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(function(e){var t=e.connectDragSource,n=e.connectDropTarget,a=e.isDragging,o=e.isHovering,c=e.caption,i=e.onRemove;return t(n(r.a.createElement("li",{className:"places__item",style:{opacity:a?0:1,color:o&&!a?"#3589eb":"inherit"}},c,r.a.createElement("button",{className:"places__item-remove",onClick:i},"\u2715"))))})),k=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.points,n=e.onRemoveItem,a=e.onDropItem;return t.length?r.a.createElement("ul",{className:"places"},t.map(function(e,t){return r.a.createElement(R,{key:e.id,id:e.id,index:t,caption:e.caption,onRemove:function(){return n(e.id)},onDrop:a})})):null}}]),t}(r.a.PureComponent),x=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.points,n=e.onChangeLocation;if(!t.length)return null;var a=t.map(function(e){return e.coords});return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.Polyline,{geometry:a}),t.map(function(e,t){return r.a.createElement(l.Placemark,{key:e.id,geometry:e.coords,properties:{iconContent:t+1,balloonContent:e.balloonContent},options:{draggable:!0,iconColor:"#ff0000"},modules:["geoObject.addon.balloon"],onDragEnd:function(t){var a=t.originalEvent.target.geometry.getCoordinates();n(e.id,a)}})}))}}]),t}(r.a.PureComponent),I=(n(204),function(e){function t(){var e,n;Object(b.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).state={searchValue:"",points:[],ymaps:null,map:null},n.setMapRef=function(e){console.log("MAP_REF_SET"),n.setState({map:e})},n.setYmapsRef=function(e){n.setState({ymaps:e})},n.handleSearchChange=function(e){n.setState({searchValue:e.target.value})},n.handleSearchSubmit=function(){var e=Object(g.a)(h.a.mark(function e(t){var a,r,o,c,i,s,u,l;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=n.state,r=a.ymaps,o=a.searchValue,c=a.points,i=a.map,o){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,e.next=7,r.geocode(o,{results:1});case 7:s=e.sent,u=s.geoObjects.get(0),l={id:"id_"+y()(),coords:u.geometry.getCoordinates(),caption:u.properties.get("text"),balloonContent:u.properties.get("balloonContent")},i.setCenter(l.coords),n.setState({searchValue:"",points:[].concat(Object(d.a)(c),[l])}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),console.log("SEARCH_ERROR: ",e.t0);case 17:case"end":return e.stop()}},e,this,[[4,14]])}));return function(t){return e.apply(this,arguments)}}(),n.handleItemRemove=function(e){var t=n.state,a=t.points,r=t.map,o=a.filter(function(t){return t.id!==e});o.length&&r.setCenter(o[o.length-1].coords),n.setState({points:o})},n.handleItemDrop=function(e,t){var a=n.state.points,r=Object(d.a)(a),o=r[e],c=r[t];r[e]=c,r[t]=o,n.setState({points:r})},n.handlePointChangeLocation=function(){var e=Object(g.a)(h.a.mark(function e(t,a){var r,o,c,i,s,u;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.state,o=r.points,c=r.ymaps,e.prev=1,e.next=4,c.geocode(a,{results:1});case 4:i=e.sent,s=i.geoObjects.get(0),u=o.reduce(function(e,n){if(n.id===t){var r=Object(p.a)({},n,{coords:a,caption:s.getAddressLine(),balloonContent:s.properties.get("balloonContent")});return[].concat(Object(d.a)(e),[r])}return[].concat(Object(d.a)(e),[n])},[]),n.setState({points:u}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("CHANGE_LOCATION_ERROR: ",e.t0);case 13:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t,n){return e.apply(this,arguments)}}(),n}return Object(j.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.searchValue,n=e.points;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E,{value:t,onChange:this.handleSearchChange,onSubmit:this.handleSearchSubmit}),r.a.createElement(k,{points:n,onRemoveItem:this.handleItemRemove,onDropItem:this.handleItemDrop}),r.a.createElement(l.Map,{defaultState:S,width:"100%",height:"100vh",onLoad:this.setYmapsRef,instanceRef:this.setMapRef},r.a.createElement(x,{points:n,onChangeLocation:this.handlePointChangeLocation})))}}]),t}(r.a.Component));n(205);c.a.render(r.a.createElement(i.DragDropContextProvider,{backend:u.a},r.a.createElement(l.YMaps,{query:{load:"geocode",apikey:"eeb0c9a9-72eb-497b-a566-b040ed89c6c1"}},r.a.createElement(I,null))),document.getElementById("root"))},74:function(e,t,n){e.exports=n(206)}},[[74,1,2]]]);
//# sourceMappingURL=main.94da18d3.chunk.js.map